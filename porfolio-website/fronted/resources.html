<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resources - Tanush Guha</title> <!-- ★ Title Updated ★ -->

    <style>
        /* --- Global Styles & Variables (Consistent with other pages) --- */
        :root {
            /* Primary Palette - Inspired by Screenshot */
            --light-color: #edf2f7;     /* Light Blue Background (like Tailwind's blue-100) */
            --accent-color: #ffffff;    /* White (for Cards, Placeholders, Header BG) */
            --dark-color: #1a202c;     /* Dark Grey/Charcoal (Headings, Footer BG, Hover states) */
            --text-color: #2d3748;     /* Dark Grey Text (Slightly lighter than dark-color) */
            --text-muted: #718096;     /* Medium Grey-Blue (Muted Text, Borders) */
            --primary-color: #3b82f6; /* Clear Blue (Links, Buttons, Active States - like Tailwind blue-500) */
            --secondary-color: #93c5fd; /* Lighter shade of primary for gradients (e.g., skill bar - like Tailwind blue-300) */
            --font-primary: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --font-heading: 'Georgia', serif;
            --spacing-unit: 1rem;
            --border-radius: 5px;
            --transition-speed: 0.3s;
            --shadow-light: 0 2px 5px rgba(45, 55, 72, 0.08);
            --shadow-medium: 0 4px 10px rgba(45, 55, 72, 0.1);
            --success-bg: #d1fae5;
            --success-text: #047857;
            --error-bg: #fee2e2;
            --error-text: #b91c1c;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; font-size: 100%; }
        body {
            font-family: var(--font-primary);
            line-height: 1.6;
            background-color: var(--light-color);
            color: var(--text-color);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        main { flex-grow: 1; }
        .container { max-width: 1100px; margin: 0 auto; padding: 0 calc(var(--spacing-unit) * 1.5); }
        h1, h2, h3 { font-family: var(--font-heading); color: var(--dark-color); line-height: 1.2; margin-bottom: calc(var(--spacing-unit) * 0.8); }
        h1 { font-size: 2.8rem; }
        h2 { font-size: 2rem; text-align: center; margin-bottom: calc(var(--spacing-unit) * 2.5);}
        h3 { font-size: 1.4rem; color: var(--primary-color); }
        p { margin-bottom: var(--spacing-unit); color: var(--text-muted); }
        a { color: var(--primary-color); text-decoration: none; transition: color var(--transition-speed) ease; }
        a:hover { color: var(--dark-color); }
        img { max-width: 100%; height: auto; display: block; }

        /* --- Utilities --- */
        .fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }
        .loading-message, .error-message { text-align: center; margin-top: calc(var(--spacing-unit) * 2); font-style: italic; color: var(--text-muted); }

        /* --- Header & Navigation (Consistent) --- */
        .main-header { background-color: #fff; box-shadow: var(--shadow-light); padding: var(--spacing-unit) 0; position: sticky; top: 0; z-index: 1000; width: 100%; }
        .main-nav { display: flex; justify-content: flex-end; align-items: center; }
        .nav-links { list-style: none; display: flex; }
        .nav-links li { margin-left: calc(var(--spacing-unit) * 1.8); }
        .nav-links a { color: var(--text-muted); font-weight: 500; padding: 0.5rem 0; position: relative; letter-spacing: 0.5px; }
        .nav-links a::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0; height: 2px; background-color: var(--primary-color); transition: width var(--transition-speed) ease; }
        .nav-links a:hover::after, .nav-links a.active::after { width: 100%; }
        .nav-links a:hover, .nav-links a.active { color: var(--primary-color); }

        /* --- Resources Section (Reusing Project Styles) --- */
        /* ★ Section ID Changed, but reusing styles is fine ★ */
        #resources-section { /* Renamed from #projects-section */
            padding: calc(var(--spacing-unit) * 4) 0;
            background-color: var(--light-color);
        }

        .resources-grid { /* Renamed from .projects-grid */
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: calc(var(--spacing-unit) * 2.5);
        }

        /* ★ Reusing .project-card style for resources ★ */
        /* You could create .resource-card if you want different styling */
        .project-card {
            background-color: #fff;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            display: flex;
            flex-direction: column;
             /* Removed overflow: hidden; as images aren't used */
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        /* ★ Image styles below are NOT USED for resources, but kept for CSS consistency if reusing .project-card */
        /* Container for the image */
        .project-card-image {
             /* height: 200px; No fixed height needed */
             background-color: transparent; /* No placeholder needed */
             overflow: hidden;
             display: none; /* Hide this element for resource cards */
         }
        .project-card-image img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s ease; }
        .project-card:hover .project-card-image img { transform: scale(1.05); }
        .project-card-image-placeholder { font-size: 1.5rem; color: rgba(255, 255, 255, 0.7); }

        .project-card-content {
            padding: calc(var(--spacing-unit) * 1.5);
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .project-card h3 { /* Applies to Resource title */
            font-size: 1.3rem;
            margin-bottom: calc(var(--spacing-unit) * 0.7);
            color: var(--dark-color);
        }

        .project-card p { /* Applies to Resource description */
            font-size: 0.95rem;
            margin-bottom: calc(var(--spacing-unit) * 1.5);
            flex-grow: 1; /* Push button to bottom */
        }

        /* Applies to Resource download link */
        .project-link {
            display: inline-block;
            background-color: var(--primary-color);
            color: var(--light-color) !important; /* Ensure text is light */
            padding: calc(var(--spacing-unit) * 0.7) calc(var(--spacing-unit) * 1.5);
            border-radius: var(--border-radius);
            font-weight: 500;
            transition: background-color var(--transition-speed) ease, transform 0.2s ease;
            box-shadow: var(--shadow-light);
            text-align: center;
            margin-top: auto; /* Push to bottom */
            align-self: flex-start;
            text-decoration: none;
        }
        .project-link:hover {
            background-color: var(--dark-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        /* --- Footer (Consistent) --- */
        .main-footer { text-align: center; padding: calc(var(--spacing-unit) * 2.5) 0; background-color: var(--dark-color); color: var(--accent-color); font-size: 0.9rem; width: 100%; margin-top: auto; /* Ensures footer is pushed down */}
        .main-footer p { color: var(--secondary-color); margin-bottom: 0; }

        /* --- Responsiveness --- */
        @media (max-width: 768px) {
             .main-nav { justify-content: center; }
             .nav-links li { margin-left: var(--spacing-unit); margin-right: var(--spacing-unit); }
             h2 { font-size: 1.8rem; }
             .resources-grid { gap: calc(var(--spacing-unit) * 2); } /* Updated class */
             /* .project-card-image { height: 180px; } No image height needed */
        }
        @media (max-width: 480px) {
             html { font-size: 95%; }
             .nav-links { font-size: 0.9rem; }
             .nav-links li { margin-left: calc(var(--spacing-unit)*0.8); margin-right: calc(var(--spacing-unit)*0.8); }
             .project-card-content { padding: calc(var(--spacing-unit) * 1.2); }
             .project-card h3 { font-size: 1.2rem; }
             /* .project-card-image { height: 160px; } No image height needed */
        }

    </style>
</head>
<body>

    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <nav class="main-nav">
                <ul class="nav-links">
                    <li><a href="index.html">About Me</a></li>
                    <li><a href="projects.html">Projects</a></li>
                    <li><a href="qualifications.html">Qualifications</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="resources.html" class="active">Resources</a></li> <!-- ★ Active page ★ -->
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main>
        <!-- ★ Section ID updated ★ -->
        <section id="resources-section">
            <div class="container">
                <h2>Resources & Documents</h2> <!-- ★ Heading updated ★ -->

                <!-- ★ Grid ID and class updated ★ -->
                <div id="resources-grid" class="resources-grid">
                    <!-- ★ Loading message updated ★ -->
                    <p id="loading-message" class="loading-message">Loading resources...</p>
                    <p id="error-message" class="error-message" style="display: none;"></p>
                    <!-- Resource cards injected here -->
                </div>

            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <!-- ★ EDIT: Add your name ★ -->
            <p>© <span id="current-year"></span> Tanush Guha. All rights reserved.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // ★ Targeting updated grid ID ★
        const resourcesGrid = document.getElementById('resources-grid');
        const loadingMessage = document.getElementById('loading-message');
        const errorMessage = document.getElementById('error-message');
        // ★ API Endpoint updated ★
        const API_ENDPOINT = 'https://portfolio-website-4yp2.onrender.com/get_resources';

        // --- Function to Create and Populate Resource Cards ---
        // ★ Renamed function, updated logic ★
        function displayResources(resourcesData) {
            loadingMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            resourcesGrid.innerHTML = ''; // Clear grid

            if (!resourcesData || resourcesData.length === 0) {
                resourcesGrid.innerHTML = '<p class="loading-message">No resources found.</p>';
                return;
            }

            resourcesData.forEach(resource => {
                // --- Expected data from backend: { id, title, description, pdf_filename } ---
                const { id, title, description, pdf_filename } = resource;

                // --- Create card elements ---
                const card = document.createElement('div');
                // Reusing project-card style, add resource-card class if specific styling is needed later
                card.className = 'project-card fade-in';

                // --- Create Content Area ---
                const contentDiv = document.createElement('div');
                contentDiv.className = 'project-card-content'; // Reuse style

                const titleEl = document.createElement('h3');
                titleEl.textContent = title || 'Untitled Resource'; // Use resource title

                const descriptionEl = document.createElement('p');
                // Use 'description' field from resource data
                descriptionEl.textContent = description || 'No description available.';

                contentDiv.appendChild(titleEl);
                contentDiv.appendChild(descriptionEl);

                // --- Create Download Link/Button ---
                if (pdf_filename) {
                    const linkEl = document.createElement('a');
                    linkEl.className = 'project-link'; // Reuse style
                    // Construct the path assuming PDFs are in /documents/ folder at site root
                    linkEl.href = `/documents/${pdf_filename}`;
                    linkEl.textContent = 'View/Download PDF';
                    linkEl.target = '_blank'; // Open in new tab
                    linkEl.rel = 'noopener noreferrer'; // Security measure
                    // Optional: Add download attribute to suggest filename
                    // linkEl.setAttribute('download', pdf_filename);
                    contentDiv.appendChild(linkEl); // Add link to content
                } else {
                    console.warn(`Resource ID ${id} has no pdf_filename.`);
                    // Optionally add a placeholder or message if no file link
                     const noFileText = document.createElement('p');
                     noFileText.textContent = 'No file available.';
                     noFileText.style.fontStyle = 'italic';
                     contentDiv.appendChild(noFileText);
                }

                // No image container needed for resources
                // card.appendChild(imageContainer);

                card.appendChild(contentDiv); // Add content div
                resourcesGrid.appendChild(card); // Add completed card to grid
            });

            // Initialize the observer after cards are added
            initializeObserver();
        }

        // --- Function to Fetch Resource Data ---
        // ★ Renamed function, updated logic & error messages ★
        async function fetchResources() {
            try {
                const response = await fetch(API_ENDPOINT); // Uses updated endpoint
                if (!response.ok) {
                    let errorBody = 'Could not retrieve error details.';
                    try { errorBody = await response.text(); } catch(e) { /* Ignore */ }
                    throw new Error(`HTTP error! Status: ${response.status}. Details: ${errorBody}`);
                }
                const data = await response.json();

                console.log("Fetched resource data:", data); // Log for debugging

                if (!Array.isArray(data)) {
                    // Handle cases where the backend might not return an array
                    // (e.g., if the table is empty and it returns null or an object)
                    if (data === null || typeof data !== 'object') {
                         throw new Error(`API did not return an array or valid object. Received: ${typeof data}`);
                    }
                    // If it's an empty object or similar, treat as empty array
                    if(Object.keys(data).length === 0 && data.constructor === Object) {
                         console.warn("API returned an empty object, treating as no resources found.");
                         displayResources([]); // Display empty state
                         return;
                    }
                    // Otherwise, if it's not an array but has content, it's unexpected
                     throw new Error(`API did not return an array. Received: ${typeof data}`);
                }

                displayResources(data); // Call renamed display function

            } catch (error) {
                console.error('Error fetching resources:', error); // Updated log message
                loadingMessage.style.display = 'none';
                // Updated error message text
                errorMessage.textContent = `Failed to load resources. Please check the backend connection or API response. (Error: ${error.message})`;
                errorMessage.style.display = 'block';
                resourcesGrid.innerHTML = ''; // Clear grid on error
            }
        }

        // --- Intersection Observer for Fade-in Animation ---
        // ★ Kept the same - reusing .project-card class for fade-in ★
        let observer;
        function initializeObserver() {
            // Selects elements with .project-card and .fade-in
            // If you add a .resource-card class later, update this selector
            const fadeInElements = document.querySelectorAll('.project-card.fade-in');
            if (observer) { observer.disconnect(); } // Disconnect previous if re-initializing

            const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
            observer = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        obs.unobserve(entry.target); // Stop observing once visible
                    }
                });
            }, observerOptions);

            fadeInElements.forEach(el => {
                el.classList.remove('visible'); // Ensure it starts invisible
                observer.observe(el);
            });
        }

        // --- Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            const currentYearEl = document.getElementById('current-year');
            if(currentYearEl) { currentYearEl.textContent = new Date().getFullYear(); }
            fetchResources(); // ★ Call the renamed fetch function ★
        });

    </script>

</body>
</html>